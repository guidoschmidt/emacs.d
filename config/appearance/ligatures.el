;;; ligatures --- Configure font ligatures -*- lexical-binding: t -*-
;;; Commentary:

;;; Code:
;; (defun setup-pragmata-ligatures ()
;;   (setq prettify-symbols-alist
;;         (append prettify-symbols-alist
;; '(;;("!!"   . ?îœ )
;; ("!="   . ?îœ¡)
;; ("!=="  . ?îœ¢)
;; ("!â‰¡"   . ?îœ¤)
;; ("!â‰¡â‰¡"  . ?îœ¥)
;; ("!>"   . ?îœ¦)
;; ("#("   . ?î€)
;; ("#_"   . ?î)
;; ("#{"   . ?î‚)
;; ("#?"   . ?îƒ)
;; ("#>"   . ?î„)
;; ("%="   . ?î)
;; ("%>"   . ?î‘)
;; ("<~"   . ?îŸ)
;; ("&%"   . ?î )
;; ("&&"   . ?î¡)
;; ("&*"   . ?î¢)
;; ("&+"   . ?î£)
;; ("&-"   . ?î¤)
;; ("&/"   . ?î¥)
;; ("&="   . ?î¦)
;; ("&&&"  . ?î§)
;; ("&>"   . ?î¨)
;; ("$>"   . ?îµ)
;; ("~>"   . ?î¿)
;; ("***"  . ?î€) ; I prefer not to use this one
;; ("*="   . ?î)
;; ("*/"   . ?î‚)
;; ("*>"   . ?îƒ)
;; ("++"   . ?î)
;; ("+++"  . ?î‘)
;; ("+="   . ?î’)
;; ("+>"   . ?î“)
;; ("--"   . ?î )
;; ("-<"   . ?î¡)
;; ("-<<"  . ?î¢)
;; ("-="   . ?î£)
;; ("->>"  . ?î¥)
;; ("---"  . ?î¦)
;; ("-->"  . ?î§)
;; (".."   . ?î°)
;; ("..."  . ?î±)
;; ("..<"  . ?î²)
;; (".>"   . ?î³)
;; (".~"   . ?î´)
;; (".="   . ?îµ)
;; ("/*"   . ?îŸ€)
;; ("//"   . ?îŸ)
;; ("/>"   . ?îŸ‚)
;; ("/="   . ?îŸƒ)
;; ("/=="  . ?îŸ„)
;; ("///"  . ?îŸ…)
;; ("/**"  . ?îŸ†)
;; ("::"   . ?îŸ)
;; (":="   . ?îŸ‘)
;; (":â‰¡"   . ?îŸ’)
;; (":>"   . ?îŸ“)
;; (":=>"  . ?îŸ”)
;; ("<$>"  . ?îŸ )
;; ("<*"   . ?îŸ¡)
;; ("<*>"  . ?îŸ¢)
;; ("<+>"  . ?îŸ£)
;; ("<-"   . ?îŸ¤) ; I like different arrows (see below)
;; ("<<"   . ?îŸ¥)
;; ("<<<"  . ?îŸ¦)
;; ("<<="  . ?îŸ§)
;; ("<="   . ?îŸ¨)
;; ("<=>"  . ?îŸ©) ; I like different arrows (see below)
;; ("<>"   . ?îŸª)
;; ("<|>"  . ?îŸ«)
;; ("<<-"  . ?îŸ¬)
;; ("<|"   . ?îŸ­)
;; ("<=<"  . ?îŸ®)
;; ("<~~"  . ?îŸ°)
;; ("<<~"  . ?îŸ±)
;; ("<$"   . ?îŸ²)
;; ("<+"   . ?îŸ³)
;; ("<!>"  . ?îŸ´)
;; ("<@>"  . ?îŸµ)
;; ("<#>"  . ?îŸ¶)
;; ("<%>"  . ?îŸ·)
;; ("<^>"  . ?îŸ¸)
;; ("<&>"  . ?îŸ¹)
;; ("<?>"  . ?îŸº)
;; ("<.>"  . ?îŸ»)
;; ("</>"  . ?îŸ¼)
;; ("<\>"  . ?îŸ½)
;; ("<\">" . ?îŸ¾)
;; ("<:>"  . ?îŸ¿)
;; ("<~>"  . ?î €)
;; ("<**>" . ?î )
;; ("<<^"  . ?î ‚)
;; ("<!"   . ?î ƒ)
;; ("<@"   . ?î „)
;; ("<#"   . ?î …)
;; ("<%"   . ?î †)
;; ("<^"   . ?î ‡)
;; ("<&"   . ?î ˆ)
;; ("<?"   . ?î ‰)
;; ("<."   . ?î Š)
;; ("</"   . ?î ‹)
;; ("<\\"  . ?î Œ)
;; ("<\""  . ?î )
;; ("<:"   . ?î )
;; ("<->"  . ?î )
;; ("<!--" . ?î )
;; ("<--"  . ?î ‘)
;; ("=<<"  . ?î  )
;; ("=="   . ?î ¡)
;; ("==="  . ?î ¢)
;; ("==>"  . ?î £) ; I like different arrows (see below)
;; ("=>"   . ?î ¤)  ; I like different arrows (see below)
;; ("=~"   . ?î ¥)
;; ("=>>"  . ?î ¦)
;; ("â‰¡â‰¡"   . ?î °)
;; ("â‰¡â‰¡â‰¡"  . ?î ±)
;; ("â‰¡:â‰¡"  . ?î ²)
;; (">-"   . ?î¡€)
;; (">="   . ?î¡)
;; (">>"   . ?î¡‚)
;; (">>-"  . ?î¡ƒ)
;; (">>="  . ?î¡„)
;; (">>>"  . ?î¡…)
;; (">=>"  . ?î¡†)
;; (">>^"  . ?î¡‡)
;; ("??"   . ?î¡ )
;; ("?~"   . ?î¡¡)
;; ("?="   . ?î¡¢)
;; ("?>"   . ?î¡£)
;; ("^="   . ?î¡¨)
;; ("^."   . ?î¡©)
;; ("^?"   . ?î¡ª)
;; ("^.."  . ?î¡«)
;; ("^<<"  . ?î¡¬)
;; ("^>>"  . ?î¡­)
;; ("^>"   . ?î¡®)
;; ("\\\\" . ?î¡°)
;; ("\\>"  . ?î¡±)
;; ("@>"   . ?î¡·)
;; ("|="   . ?î¢€)
;; ("||"   . ?î¢)
;; ("|>"   . ?î¢‚)
;; ("|||"  . ?î¢ƒ)
;; ("|+|"  . ?î¢„)
;; ("~="   . ?î¢)
;; ("~~>"  . ?î¢’)
;; ("~>>"  . ?î¢“)

;; Personal preference: I like this set of arrows better than default
;; ("<-"   . ?ğŸ¡)
;; ("->"   . ?ğŸ¡’)
;; ("=>"   . ?â‡’)
;; ("<=>"  . ?âŸº)
;; ("<==>" . ?âŸº)
;; ("==>"  . ?âŸ¹)
;; ("<=="  . ?âŸ¸)
;; ("|->"  . ?âŸ¼)
;; ("<-|"  . ?âŸ»)
;; ("|=>"  . ?âŸ¾)
;; ("<=|"  . ?âŸ½)
;; ))))

;; (defun refresh-pretty ()
;;   (prettify-symbols-mode -1)
;;   (prettify-symbols-mode +1))

;; Hooks for modes in which to install the Pragmata ligatures
;; (mapc (lambda (hook)
;;         (add-hook hook (lambda () (setup-pragmata-ligatures) (refresh-pretty))))
;;       '(text-mode-hook
;;         prog-mode-hook))

;; (global-prettify-symbols-mode +1)

(let ((alist '((33 . ".\\(?:\\(?:==\\|!!\\)\\|[!=]\\)")
               (35 . ".\\(?:###\\|##\\|_(\\|[#(?[_{]\\)")
               (36 . ".\\(?:>\\)")
               (37 . ".\\(?:\\(?:%%\\)\\|%\\)")
               (38 . ".\\(?:\\(?:&&\\)\\|&\\)")
               (42 . ".\\(?:\\(?:\\*\\*/\\)\\|\\(?:\\*[*/]\\)\\|[*/>]\\)")
               (43 . ".\\(?:\\(?:\\+\\+\\)\\|[+>]\\)")
               (45 . ".\\(?:\\(?:-[>-]\\|<<\\|>>\\)\\|[<>}~-]\\)")
               ;; May produce: error in process filter: Attempt to shape unibyte text
               ;; (46 . ".\\(?:\\(?:\\.[.<]\\)\\|[.=-]\\)")
               (47 . ".\\(?:\\(?:\\*\\*\\|//\\|==\\)\\|[*/=>]\\)")
               (48 . ".\\(?:x[a-zA-Z]\\)")
               (58 . ".\\(?:::\\|[:=]\\)")
               (59 . ".\\(?:;;\\|;\\)")
               (60 . ".\\(?:\\(?:!--\\)\\|\\(?:~~\\|->\\|\\$>\\|\\*>\\|\\+>\\|--\\|<[<=-]\\|=[<=>]\\||>\\)\\|[*$+~/<=>|-]\\)")
               (61 . ".\\(?:\\(?:/=\\|:=\\|<<\\|=[=>]\\|>>\\)\\|[<=>~]\\)")
               (62 . ".\\(?:\\(?:=>\\|>[=>-]\\)\\|[=>-]\\)")
               (63 . ".\\(?:\\(\\?\\?\\)\\|[:=?]\\)")
               (91 . ".\\(?:]\\)")
               (92 . ".\\(?:\\(?:\\\\\\\\\\)\\|\\\\\\)")
               (94 . ".\\(?:=\\)")
               (119 . ".\\(?:ww\\)")
               (123 . ".\\(?:-\\)")
               (124 . ".\\(?:\\(?:|[=|]\\)\\|[=>|]\\)")
               (126 . ".\\(?:~>\\|~~\\|[>=@~-]\\)")
               )
             ))
  (dolist (char-regexp alist)
    (set-char-table-range composition-function-table (car char-regexp)
                          `([,(cdr char-regexp) 0 font-shape-gstring]))))

(provide 'ligatures)
;;; ligatures ends here
